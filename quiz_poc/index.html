<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <title>Paiza API Quiz App</title>
    <style>
        #editor { height: 300px; width: 100%; border: 1px solid #ccc; }
        .result-box { margin-top: 20px; padding: 10px; background: #f0f0f0; }
        .pass { color: green; font-weight: bold; }
        .fail { color: red; font-weight: bold; }
    </style>
</head>
<body>
    <input type="hidden" id="quiz-id" value="{{ quiz.id }}">
    <h1>競技プログラミング風アプリ</h1>

    <div id="problem-area">
        <!-- Flaskから渡された問題データを表示 -->
        <h2>問題: {{ quiz.title }}</h2>
        <p>{{ quiz.description }}</p>
    </div>

    <div id="editor"></div>

    <div class="result-box" style="margin-top: 10px;">
        <h3>sysin とテストケース</h3>
        <p>{{ quiz.sysin_format }}</p>
        <ul>
        {% for case in quiz.test_cases %}
            <li><code>sysin = {{ case.sysin }}</code> → 期待される出力: <code>{{ case.expected }}</code></li>
        {% endfor %}
        </ul>
    </div>

    <div class="result-box" style="margin-top: 10px;">
        <h3>模範解答コード</h3>
        <button id="show-answer-btn" style="padding:8px 16px;">答えを見る</button>
        <pre id="sample-code" style="display:none; margin-top:10px;">{{ quiz.sample_code }}</pre>
    </div>

    <button id="exec-btn" style="margin-top:10px; padding:10px 20px;">実行</button>
    <button id="submit-btn" style="margin-top:10px; padding:10px 20px;">提出</button>

    <div id="result-area" class="result-box">
        ここに実行結果が表示されます...
    </div>

    <!-- Ace Editor CDN -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/ace/1.4.12/ace.js"></script>
    <!-- モジュールの読み込み -->
    <!-- Flaskのstaticフォルダ設定に合わせてパスを調整 -->
    <script src="/js/editor.js"></script>
    <script src="/js/run_code.js"></script>

    <script>
    document.addEventListener('DOMContentLoaded', function () {
        const btn = document.getElementById('show-answer-btn');
        const pre = document.getElementById('sample-code');
        if (!btn || !pre) return;

        btn.addEventListener('click', function () {
            const isHidden = pre.style.display === 'none' || pre.style.display === '';
            pre.style.display = isHidden ? 'block' : 'none';
            btn.textContent = isHidden ? '答えを隠す' : '答えを見る';
        });
    });
    </script>

</body>
</html>
